The refactored code is in the dominion file.
